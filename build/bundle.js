(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error('Uncaught, unspecified "error" event. ('+er+")");err.context=er;throw err}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else if(listeners){while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;else if(evlistener)return evlistener.length}return 0};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],2:[function(require,module,exports){exports=module.exports=require("./debug");exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage();exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}exports.formatters.j=function(v){return JSON.stringify(v)};function formatArgs(){var args=arguments;var useColors=this.useColors;args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff);if(!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0;var lastC=0;args[0].replace(/%[a-z%]/g,function(match){if("%%"===match)return;index++;if("%c"===match){lastC=index}});args.splice(lastC,0,c);return args}function log(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(namespaces){try{if(null==namespaces){exports.storage.removeItem("debug")}else{exports.storage.debug=namespaces}}catch(e){}}function load(){var r;try{r=exports.storage.debug}catch(e){}return r}exports.enable(load());function localstorage(){try{return window.localStorage}catch(e){}}},{"./debug":3}],3:[function(require,module,exports){exports=module.exports=debug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=require("ms");exports.names=[];exports.skips=[];exports.formatters={};var prevColor=0;var prevTime;function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}disabled.enabled=false;function enabled(){var self=enabled;var curr=+new Date;var ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;if(null==self.useColors)self.useColors=exports.useColors();if(null==self.color&&self.useColors)self.color=selectColor();var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]);if("string"!==typeof args[0]){args=["%o"].concat(args)}var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if(match==="%%")return match;index++;var formatter=exports.formatters[format];if("function"===typeof formatter){var val=args[index];match=formatter.call(self,val);args.splice(index,1);index--}return match});if("function"===typeof exports.formatArgs){args=exports.formatArgs.apply(self,args)}var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}enabled.enabled=true;var fn=exports.enabled(namespace)?enabled:disabled;fn.namespace=namespace;return fn}function enable(namespaces){exports.save(namespaces);var split=(namespaces||"").split(/[\s,]+/);var len=split.length;for(var i=0;i<len;i++){if(!split[i])continue;namespaces=split[i].replace(/\*/g,".*?");if(namespaces[0]==="-"){exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$"))}else{exports.names.push(new RegExp("^"+namespaces+"$"))}}}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++){if(exports.skips[i].test(name)){return false}}for(i=0,len=exports.names.length;i<len;i++){if(exports.names[i].test(name)){return true}}return false}function coerce(val){if(val instanceof Error)return val.stack||val.message;return val}},{ms:4}],4:[function(require,module,exports){var s=1e3;var m=s*60;var h=m*60;var d=h*24;var y=d*365.25;module.exports=function(val,options){options=options||{};if("string"==typeof val)return parse(val);return options.long?long(val):short(val)};function parse(str){str=""+str;if(str.length>1e4)return;var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(!match)return;var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}function short(ms){if(ms>=d)return Math.round(ms/d)+"d";if(ms>=h)return Math.round(ms/h)+"h";if(ms>=m)return Math.round(ms/m)+"m";if(ms>=s)return Math.round(ms/s)+"s";return ms+"ms"}function long(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){if(ms<n)return;if(ms<n*1.5)return Math.floor(ms/n)+" "+name;return Math.ceil(ms/n)+" "+name+"s"}},{}],5:[function(require,module,exports){"use strict";module.exports=function(str,sep){if(typeof str!=="string"){throw new TypeError("Expected a string")}sep=typeof sep==="undefined"?"_":sep;return str.replace(/([a-z\d])([A-Z])/g,"$1"+sep+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+sep+"$2").toLowerCase()}},{}],6:[function(require,module,exports){!function(name,definition){if(typeof module!="undefined")module.exports=definition();else if(typeof define=="function"&&typeof define.amd=="object")define(definition);else this[name]=definition()}("domready",function(){var fns=[],listener,doc=document,hack=doc.documentElement.doScroll,domContentLoaded="DOMContentLoaded",loaded=(hack?/^loaded|^c/:/^loaded|^i|^c/).test(doc.readyState);if(!loaded)doc.addEventListener(domContentLoaded,listener=function(){doc.removeEventListener(domContentLoaded,listener);loaded=1;while(listener=fns.shift())listener()});return function(fn){loaded?setTimeout(fn,0):fns.push(fn)}})},{}],7:[function(require,module,exports){"use strict";var decamelize=require("decamelize");var amenities=["tent","rv","tables","toilets","water","accessible","boat ramp","parking"];var percent=100/amenities.length;var cols=amenities.map(function(x){return'<col width="'+percent+'%" />'}).join("");function renderSummaryKey(k){var s=decamelize(k," ");return s[0].toUpperCase()+s.slice(1)}function _renderSummary(summary){if(!summary)return"";var rows=Object.keys(summary).reduce(onkey,"");function onkey(acc,k){var val=summary[k];if(val===null)return acc;return acc+("<tr><td>"+renderSummaryKey(k)+"</td><td>"+val+"</td></tr>")}return'\n    <h4>Summary</h4>\n    <table class="summary" cellspacing="0">\n      '+rows+"\n    </table>\n    "}function _renderAmenities(xs,type){if(type==="camping")xs=xs.concat("tent");function toAmenityCell(html,x){var clazz=~xs.indexOf(x)?"":"disabled";return html+('<td>\n        <img class="'+clazz+'" src="img/amenities-'+x.replace(/ /g,"-")+'.png" alt="'+x+'"\n      </td>')}var cells=amenities.reduce(toAmenityCell,"");return'\n    <table class="amenities" cellspacing="0">\n      '+cols+"\n      <tr>"+cells+"</tr>\n    </table>\n    "}exports.renderAmenities=function renderAmenities(info){var type=/cabin/i.test(info.title)?"cabin":info.type==="unkown"?"camping":info.type;return _renderAmenities(info.amenities||[],type)};exports.renderSummary=function renderSummary(info){return _renderSummary(info.summary||{})}},{decamelize:5}],8:[function(require,module,exports){"use strict";var TESTING=require("./testing");var util=require("./util");var details=require("./details");localStorage.debug=null;var domready=require("domready");var MyMap=require("./map/google-map");var entitiesWithinBounds=require("./map/bounds").entitiesWithinBounds;var campsites=require("boondocker.fs-usda-ridb");var info={platform:navigator.platform,userAgent:navigator.userAgent};console.log(info);util.addToHomeScreen();function makeRangeFn(r){return function(x){return x.fee!==null&&r[0]<x.fee&&x.fee<=r[1]}}function attachRangeFn(x){x.rangeFn=makeRangeFn(x.range);return x}var priceMap=[{category:"free",range:[-1,0]},{category:"supercheap",range:[0,5]},{category:"cheap",range:[5,10]},{category:"normal",range:[10,15]},{category:"expensive",range:[15,20]},{category:"very_expensive",range:[20,30]},{category:"prohibitive",range:[30,Infinity]}].map(attachRangeFn);campsites.forEach(attachFeeCategory);function attachFeeCategory(x){if(x.fee===null){x.feeCategory="unknown";return}for(var i=0;i<priceMap.length;i++){var val=priceMap[i];if(val.rangeFn(x)){x.feeCategory=val.category;break}}}var content=void 0;var quickinfo=void 0;var openGoogleMaps=void 0;var currentMarker=void 0;domready(ondomready);function ondomready(){content=document.getElementById("content");quickinfo=document.getElementById("quickinfo");quickinfo.addEventListener("click",onmarkerInfoClicked);openGoogleMaps=document.getElementById("open-googlemaps")}function getDetails(info){var details=Object.keys(info).reduce(function(acc,x){acc[x]=info[x];return acc},{});details.summary=Object.keys(details.summary).filter(function(x){return x!=="description"&&x!=="directions"}).reduce(function(acc,x){acc[x]=details.summary[x];return acc},{});return details}function onmarkerClicked(x){if(currentMarker)currentMarker.unselect();x.select();currentMarker=x;updateQuickInfo(x);updateOpenGoogleMaps(x)}function updateQuickInfo(x){quickinfo.innerHTML='\n    <div class="quickinfo-content">\n      <span class="fee">$'+x.fee+'</span>\n      <h4 class="title">'+x.title+"</h4>\n    </div>";x.addInfo(quickinfo)}function renderOpenGoogleMaps(x){return'\n    <a class="open unselectable" href="https://maps.google.com/maps?z=8&q='+x.lat+"+"+x.lng+"&ll="+x.lat+"+"+x.lng+'" target="_blank">\n      <img src="img/gm.open.png" alt="Open in Google Maps">\n    </a>\n    <a class="directions unselectable" href="https://maps.google.com/?saddr=My%20Location&daddr='+x.lat+",+"+x.lng+'" target="_blank">\n      <img src="img/gm.directions.png" alt="Directions in Google Maps">\n    </a>\n  '}function updateOpenGoogleMaps(x){openGoogleMaps.innerHTML=renderOpenGoogleMaps(x)}function onmarkerInfoClicked(){if(!content.classList.contains("hidden")){content.classList.remove("visible");return content.classList.add("hidden")}var x=currentMarker;var call=x.contact?'<a class="call unselectable" href="tel:'+x.contact+'"><img src="img/call.png" alt="Call"></a>':"";var web=x.url?'<a class="web unselectable" href="'+x.url+'" target="_blank"><img src="img/website.png" alt="Goto Website"></a>':"";content.innerHTML='\n    <div class="detail">\n      '+details.renderAmenities(x.info)+'\n      <div class="links">\n        '+web+"\n        "+call+"\n        "+renderOpenGoogleMaps(x)+"\n      </div>\n      "+details.renderSummary(x.info)+"\n    </div>\n  ";content.classList.remove("hidden");content.classList.add("visible");if(!TESTING||true)return;content.innerHTML+="<h4>Details</h4>";content.appendChild(window.JsonHuman.format(getDetails(x.info)))}function matchingFilter(){return campsites.filter(function(x){return x.feeCategory!=="unknown"})}var showingTooManyWarning=false;var quickinfoBefore="";function updateMarkers(bounds,map){var inbounds=entitiesWithinBounds(bounds,matchingFilter());if(inbounds.length>400){if(!showingTooManyWarning)quickinfoBefore=quickinfo.innerHTML;quickinfo.innerHTML="\n      <h2>Too many campsites ("+inbounds.length+") within this area</h2>\n      <h3><em>Please zoom in further</em></h3>\n    ";showingTooManyWarning=true;map.clearMarkersExcept({idsHash:{}});return}if(showingTooManyWarning){quickinfo.innerHTML=quickinfoBefore;showingTooManyWarning=false}function onmarker(acc,x){acc[x.uid]=true;return acc}map.clearMarkersExcept({idsHash:inbounds.reduce(onmarker,{})});inbounds.forEach(function(x){return map.updateMarker({id:x.uid,position:x.location,type:x.type,price:x.feeCategory,info:x})})}function updateMap(){var bounds=this.getBounds();updateMarkers(bounds,this)}function initMap(){var map=new MyMap({getElement:function getElement(){return document.getElementById("map")},getQuickinfo:function getQuickinfo(){return document.getElementById("quickinfo")},getOpenGoogleMaps:function getOpenGoogleMaps(){return document.getElementById("open-googlemaps")}});map.init();map.on("idle",updateMap);map.on("zoom-changed",updateMap);map.on("marker-clicked",onmarkerClicked);map.on("marker-info-clicked",onmarkerInfoClicked)}window.initMap=initMap},{"./details":7,"./map/bounds":9,"./map/google-map":10,"./testing":14,"./util":15,"boondocker.fs-usda-ridb":"boondocker.fs-usda-ridb",domready:6}],9:[function(require,module,exports){"use strict";exports.entitiesWithinBounds=function entitiesWithinBounds(_ref,entities){var ne=_ref.ne;var sw=_ref.sw;var minlat=sw.lat();var maxlat=ne.lat();var minlng=sw.lng();var maxlng=ne.lng();function withinBounds(e){var lat=e.location.lat;var lng=e.location.lng;return minlat<lat&&lat<maxlat&&minlng<lng&&lng<maxlng}return entities.filter(withinBounds)}},{}],10:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var EventEmitter=require("events").EventEmitter;var getCurrentLatLng=require("./location").getCurrentLatLng;var createCampsiteMarker=require("./google-marker.campsite");var createUserMarker=require("./google-marker.user");var debug_marker_add=require("debug")("map:marker:add");var debug_marker_rm=require("debug")("map:marker:rm");var debug_marker_ref=require("debug")("map:marker:ref");var scaling=[0,5,5,5,5,5,5,5,6.5,7,8,9,10,11,12,13,14,15,16,17,18];var GoogleMap=function(_EventEmitter){_inherits(GoogleMap,_EventEmitter);function GoogleMap(_ref){var getElement=_ref.getElement;var getQuickinfo=_ref.getQuickinfo;var getOpenGoogleMaps=_ref.getOpenGoogleMaps;var _ref$zoom=_ref.zoom;var zoom=_ref$zoom===undefined?10:_ref$zoom;_classCallCheck(this,GoogleMap);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(GoogleMap).call(this));_this._getElement=getElement;_this._getQuickinfo=getQuickinfo;_this._getOpenGoogleMaps=getOpenGoogleMaps;_this._zoom=zoom;_this._markers=new Map;return _this}_createClass(GoogleMap,[{key:"init",value:function init(){var _this2=this;getCurrentLatLng(function(err,latlng){if(err)return console.error(err);_this2._onlatlng(latlng)})}},{key:"getBounds",value:function getBounds(){var ne=this._map.getBounds().getNorthEast();var sw=this._map.getBounds().getSouthWest();return{ne:ne,sw:sw}}},{key:"clearMarkersExcept",value:function clearMarkersExcept(_ref2){var _this3=this;var idsHash=_ref2.idsHash;Object.keys(this._markers).forEach(function(k){var marker=_this3._markers[k];if(idsHash[marker.id])return;_this3.removeMarker(marker)})}},{key:"updateMarker",value:function updateMarker(_ref3){var _this4=this;var id=_ref3.id;var position=_ref3.position;var type=_ref3.type;var price=_ref3.price;var info=_ref3.info;var existingMarker=this._markers[id];var marker=existingMarker||createCampsiteMarker({id:id,position:position,type:type,price:price,info:info,map:this});marker.updateMarkerIcon();if(!existingMarker){marker.on("clicked",function(){return _this4.emit("marker-clicked",marker)});marker.on("info-clicked",function(){return _this4.emit("marker-info-clicked",marker)});this._markers[id]=marker}this.addMarker(marker)}},{key:"addMarker",value:function addMarker(marker){if(marker.visible)return;marker._marker.setMap(this._map);marker.visible=true;debug_marker_add(marker.id)}},{key:"removeMarker",value:function removeMarker(marker){if(!marker.visible)return;marker._marker.setMap(null);marker.visible=false;debug_marker_rm(marker.id)}},{key:"refreshMarker",value:function refreshMarker(marker){marker._marker.setMap(null);marker._marker.setMap(this._map);marker.visible=true;debug_marker_ref(marker.id)}},{key:"_onmapIdle",value:function _onmapIdle(){var _this5=this;getCurrentLatLng(function(err,latlng){if(err)return console.error(err);_this5._userMarker.updateMarkerPosition({position:latlng})});this.emit("idle")}},{key:"_onzoomChanged",value:function _onzoomChanged(){this.emit("zoom-changed")}},{key:"_onlatlng",value:function _onlatlng(latlng){var _this6=this;var maps=google.maps;this._el=this._getElement();this._quickinfo=this._getQuickinfo();this._openGoogleMaps=this._getOpenGoogleMaps();this._map=new maps.Map(this._el,{center:latlng,scrollwheel:true,zoom:this._zoom,streetViewControl:false,mapTypeControlOptions:{mapTypeIds:[]}});this._map.controls[maps.ControlPosition.TOP].push(this._quickinfo);this._map.controls[maps.ControlPosition.BOTTOM_RIGHT].push(this._openGoogleMaps);this._userMarker=createUserMarker({map:this._map,position:latlng});this._map.addListener("idle",function(){return _this6._onmapIdle()});this._map.addListener("zoom-changed",function(){return _this6._onzoomChanged()});this.emit("initialized")}},{key:"scale",get:function get(){return scaling[this._map.getZoom()]}}]);return GoogleMap}(EventEmitter);module.exports=GoogleMap},{"./google-marker.campsite":11,"./google-marker.user":12,"./location":13,debug:2,events:1}],11:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var EventEmitter=require("events").EventEmitter;var prices={free:["yellow","black"],supercheap:["orange","black"],cheap:["red","black"],normal:["blue","black"],expensive:["darkblue","transparent"],very_expensive:["#000033","transparent"],prohibitive:["darkgreen","transparent"],unknown:["white","transparent"]};function saveWidget(_ref){var el=_ref.el;var place=_ref.place;return new google.maps.SaveWidget(el,{place:place,attribution:{source:"boondocker",webUrl:"https://thlorenz.com/boondocker/web/"}})}var GoogleMarker=function(_EventEmitter){_inherits(GoogleMarker,_EventEmitter);function GoogleMarker(_ref2){var id=_ref2.id;var position=_ref2.position;var type=_ref2.type;var price=_ref2.price;var info=_ref2.info;var map=_ref2.map;_classCallCheck(this,GoogleMarker);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(GoogleMarker).call(this));_this.id=id;_this.position=position;_this.type=type;_this.price=price;_this.info=info;_this._map=map;_this._currentScale=-1;_this._createMarker();return _this}_createClass(GoogleMarker,[{key:"removeFromMap",value:function removeFromMap(){this._marker.setMap(null)}},{key:"updateMarkerIcon",value:function updateMarkerIcon(){var _ref3=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var _ref3$selected=_ref3.selected;var selected=_ref3$selected===undefined?false:_ref3$selected;var _ref3$force=_ref3.force;var force=_ref3$force===undefined?false:_ref3$force;var maps=google.maps;if(this._currentScale===this._map.scale&&!force)return false;this._currentScale=this._map.scale;var path=maps.SymbolPath.CIRCLE;var color=prices[this.price]||["transparent","transparent"];this._marker.setIcon({path:path,scale:this._map.scale,fillColor:selected?"aqua":color[0],fillOpacity:.7,strokeColor:selected?"black":color[1],strokeWeight:1});return true}},{key:"addInfo",value:function addInfo(el){this._saveWidget=saveWidget({el:el,place:this._place})}},{key:"unselect",value:function unselect(){this.updateMarkerIcon({selected:false,force:true})}},{key:"select",value:function select(){this.updateMarkerIcon({selected:true,force:true})}},{key:"_infoWindowContent",value:function _infoWindowContent(){return'\n    <div class="info-window-content">\n      <span class="fee">$'+this.fee+'</span>\n      <h4 class="title">'+this.title+"</h4>\n    </div>\n    "}},{key:"_createMarker",value:function _createMarker(){var _this2=this;var maps=google.maps;this._place={location:new maps.LatLng(this.position.lat,this.position.lng),query:this.title};this._marker=new maps.Marker({place:this._place,draggable:false,zIndex:1});maps.event.addListener(this._marker,"click",function(){return _this2.emit("clicked")})}},{key:"title",get:function get(){return this.info.title}},{key:"lat",get:function get(){return this.position.lat}},{key:"lng",get:function get(){return this.position.lng}},{key:"contact",get:function get(){return this.info.contact}},{key:"description",get:function get(){return this.info.summary.description}},{key:"directions",get:function get(){return this.info.summary.directions}},{key:"url",get:function get(){return this.info.url}},{key:"fee",get:function get(){return this.info.fee}}]);return GoogleMarker}(EventEmitter);module.exports=function createGoogleMarker(opts){return new GoogleMarker(opts)}},{events:1}],12:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=require("../util");var GoogleMarkerUser=function(){function GoogleMarkerUser(_ref){var position=_ref.position;var map=_ref.map;_classCallCheck(this,GoogleMarkerUser);this.position=position;this._map=map;this._currentScale=-1;this._createMarker()}_createClass(GoogleMarkerUser,[{key:"_createMarker",value:function _createMarker(){var maps=google.maps;this._innerMarker=new maps.Marker({position:new maps.LatLng(this.position.lat,this.position.lng),map:this._map,zIndex:5});this._outerMarker=new maps.Marker({position:new maps.LatLng(this.position.lat,this.position.lng),map:this._map,zIndex:4});var path=maps.SymbolPath.CIRCLE;this._innerMarker.setIcon({path:path,scale:6.5,fillColor:"#4285f4",fillOpacity:1,strokeColor:"white",strokeWeight:2});this._outerMarker.setIcon({path:path,scale:13,fillColor:"#4285f4",fillOpacity:.2,strokeWeight:0});this._innerMarker.setMap(this._map);this._outerMarker.setMap(this._map)}},{key:"updateMarkerPosition",value:function updateMarkerPosition(){var _ref2=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var position=_ref2.position;if(util.locationsEqual(position,this.position))return;var maps=google.maps;this.position=position;this._innerMarker.setPosition(new maps.LatLng(this.position.lat,this.position.lng));this._outerMarker.setPosition(new maps.LatLng(this.position.lat,this.position.lng))}}]);return GoogleMarkerUser}();module.exports=function createGoogleMarkerUser(opts){return new GoogleMarkerUser(opts)}},{"../util":15}],13:[function(require,module,exports){"use strict";var locations={houston:[29.593211,-95.226382],gila_nf:[33.311654,-108.884622]};exports.getCurrentLatLng=function getCurrentLatLng(cb){if(require("../testing")){var loc=locations.houston;return cb(null,{lat:loc[0],lng:loc[1]})}if(!("geolocation"in navigator))return cb(new Error("No geolocation support"));function onposition(p){cb(null,{lat:p.coords.latitude,lng:p.coords.longitude})}navigator.geolocation.getCurrentPosition(onposition)}},{"../testing":14}],14:[function(require,module,exports){"use strict";module.exports=false},{}],15:[function(require,module,exports){"use strict";exports.isPhone=function isPhone(){return/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};exports.addToHomeScreen=function addToHomeScreen(){var opts={appID:"org.boondocker.addtohome",fontSize:15,debug:false,logging:false,modal:false,mandatory:false,autostart:true,skipFirstVisit:false,startDelay:1,lifespan:15,displayPace:600,maxDisplayCount:0,icon:false,message:"",validLocation:[],onInit:null,onShow:null,onRemove:null,onAdd:null,onPrivate:null,privateModeOverride:false,detectHomescreen:true};window.addToHomescreen(opts)};exports.locationsEqual=function locationsEqual(p1,p2){return p1.lat===p2.lat&&p1.lng===p2.lng}},{}]},{},[8]);